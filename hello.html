<!DOCTYPE html>
<html>
<head>
  <title>Graph Editor</title>
  <link rel="stylesheet" href="https://unpkg.com/vis-network/standalone/umd/vis-network.min.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    
    h1 {
      text-align: center;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .form-group {
      display: flex;
      margin-bottom: 10px;
    }
    
    .form-group input[type="text"] {
      flex: 1;
      padding: 5px;
      font-size: 14px;
      border: 1px solid lightgray;
      border-radius: 3px;
    }
    
    .form-group button {
      margin-left: 5px;
      padding: 5px 10px;
      font-size: 14px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
    
    .form-group button:hover {
      background-color: #45a049;
    }
    
    #network {
      width: 100%;
      height: 400px;
      border: 1px solid lightgray;
      margin-top: 20px;
    }
  </style>
  <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
</head>
<body>
  <div class="container">
    <h1>Graph Editor</h1>
    
    <div class="form-group">
      <input type="text" id="nodeKey" placeholder="Cheie nod">
      <input type="text" id="nodeValue" placeholder="Valoare nod">
      <button onclick="addNode()">Adaugă nod</button>
    </div>
    
    <div class="form-group">
      <input type="text" id="edgeKey" placeholder="Cheie muchie">
      <input type="text" id="edgeValue" placeholder="Valoare muchie">
      <input type="text" id="edgeFrom" placeholder="Cheie nod start">
      <input type="text" id="edgeTo" placeholder="Cheie nod sfârșit">
      <button onclick="addEdge()">Adaugă muchie</button>
    </div>
    
    <div class="form-group">
      <button onclick="editSelected()">Editează</button>
      <button onclick="deleteSelected()">Șterge</button>
      <button onclick="toggleDragMode()">Mod mutare</button>
    </div>
    
    <div id="network"></div>
  </div>

  <script>
    // Inițializare rețea
    const container = document.getElementById("network");
    const data = {
      nodes: new vis.DataSet(),
      edges: new vis.DataSet()
    };
    const options = {
      manipulation: {
        enabled: false
      },
      interaction: {
        dragNodes: true
      }
    };

    const network = new vis.Network(container, data, options);
    let selectedId = null;
    let dragMode = false;

    // Funcție pentru adăugarea unui nod
    function addNode() {
      const key = document.getElementById("nodeKey").value;
      const value = document.getElementById("nodeValue").value;

      if (!data.nodes.get(key)) {
        data.nodes.add({
          id: key,
          label: value
        });
      } else {
        alert("Un nod cu această cheie există deja!");
      }
    }

    // Funcție pentru adăugarea unei muchii
    function addEdge() {
      const key = document.getElementById("edgeKey").value;
      const value = document.getElementById("edgeValue").value;
      const fromKey = document.getElementById("edgeFrom").value;
      const toKey = document.getElementById("edgeTo").value;

      const fromNode = data.nodes.get(fromKey);
      const toNode = data.nodes.get(toKey);

      if (fromNode && toNode) {
        if (!data.edges.get(key)) {
          data.edges.add({
            id: key,
            from: fromNode.id,
            to: toNode.id,
            label: value
          });
        } else {
          alert("An edge with this key already exists!");
        }
      } else {
        alert("Invalid start or end node keys!");
      }
    }


    // Funcție pentru editarea cheilor/valorilor
   // Function to edit selected node or edge
function editSelected() {
  const selectedNodes = network.getSelectedNodes();
  const selectedEdges = network.getSelectedEdges();

  if (selectedNodes.length === 1) {
    const nodeId = selectedNodes[0];
    const node = data.nodes.get(nodeId);

    const newKey = prompt("Noua cheie:", node.id);
    const newValue = prompt("Noua valoare:", node.label);

    if (newKey !== null && newValue !== null) {
      if ((newKey !== "" && !data.nodes.get(newKey)) || newKey === node.id) {
        data.nodes.update({ id: nodeId, label: newValue, title: newKey });
      } else {
        alert("O cheie cu acest nume există deja!");
      }
    }
  } else if (selectedEdges.length === 1) {
    const edgeId = selectedEdges[0];
    const edge = data.edges.get(edgeId);

    const newKey = prompt("Noua cheie:", edge.id);
    const newValue = prompt("Noua valoare:", edge.label);

    if (newKey !== null && newValue !== null) {
      if ((newKey !== "" && !data.edges.get(newKey)) || newKey === edge.id) {
        data.edges.update({ id: edgeId, label: newValue, title: newKey });
      } else {
        alert("O cheie cu acest nume există deja!");
      }
    }
  } else {
    alert("Selectați un singur nod sau o singură muchie pentru a edita.");
  }
}


    // Funcție pentru ștergerea nodurilor/muchiilor
    function deleteSelected() {
      const selectedNodes = network.getSelectedNodes();
      const selectedEdges = network.getSelectedEdges();

      if (selectedNodes.length > 0) {
        data.nodes.remove(selectedNodes);
      }

      if (selectedEdges.length > 0) {
        data.edges.remove(selectedEdges);
      }
    }

    // Funcție pentru activarea/dezactivarea modului de mutare
    function toggleDragMode() {
      dragMode = !dragMode;
      network.setOptions({ interaction: { dragNodes: dragMode } });
    }
  </script>
</body>
</html>

